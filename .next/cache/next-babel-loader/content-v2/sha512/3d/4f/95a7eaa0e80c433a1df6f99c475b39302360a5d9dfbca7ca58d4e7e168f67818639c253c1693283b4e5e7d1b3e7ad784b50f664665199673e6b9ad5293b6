{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _defineProperty from \"C:/Users/Shakhriyor_M/Desktop/course/frontend/node_modules/@babel/runtime/helpers/esm/defineProperty\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\Shakhriyor_M\\\\Desktop\\\\course\\\\frontend\\\\components\\\\auth.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$(),\n    _s3 = $RefreshSig$(),\n    _s4 = $RefreshSig$();\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport axios from \"axios\";\nimport { useRouter } from \"next/router\";\nimport { createContext, useCallback, useContext, useEffect, useMemo, useState } from \"react\";\nconst AuthContext = /*#__PURE__*/createContext();\nexport const useUser = () => {\n  _s();\n\n  const authContext = useContext(AuthContext);\n  return authContext.user;\n};\n\n_s(useUser, \"g0q6N3HTsGa67OokMUhTOzE2a0M=\");\n\nexport const useSetUser = () => {\n  _s2();\n\n  const authContext = useContext(AuthContext);\n  return authContext.setUser;\n};\n\n_s2(useSetUser, \"g0q6N3HTsGa67OokMUhTOzE2a0M=\");\n\nexport const useLoggedInOrRiderect = () => {\n  _s3();\n\n  const user = useUser();\n  const router = useRouter();\n  useEffect(() => {\n    if (user === null) {\n      router.replace(`/login/?next=${router.asPath}`);\n    }\n  }, [user]);\n  return user !== null;\n};\n\n_s3(useLoggedInOrRiderect, \"G95bazn5JtptJ5Uof9KATjucntw=\", false, function () {\n  return [useUser, useRouter];\n});\n\nconst AuthProvider = ({\n  children\n}) => {\n  _s4();\n\n  const {\n    0: state,\n    1: setState\n  } = useState({\n    user: undefined\n  });\n  const setUser = useCallback(user => {\n    setState({\n      user\n    });\n  }, []);\n  const value = useMemo(() => _objectSpread(_objectSpread({}, state), {}, {\n    setUser\n  }), [state]);\n  useEffect(() => {\n    axios.get(\"/api/session/\").then(function (response) {\n      setState({\n        user: response.data\n      });\n    }).catch(function () {\n      setState({\n        user: null\n      });\n    });\n  }, []);\n\n  if (state.user === undefined) {\n    return null;\n  }\n\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: value,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 61,\n    columnNumber: 10\n  }, this);\n};\n\n_s4(AuthProvider, \"0HX97NzbLVWpnuN79GtDgH71PP0=\");\n\n_c = AuthProvider;\nexport default AuthProvider;\n\nvar _c;\n\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"sources":["C:/Users/Shakhriyor_M/Desktop/course/frontend/components/auth.js"],"names":["axios","useRouter","createContext","useCallback","useContext","useEffect","useMemo","useState","AuthContext","useUser","authContext","user","useSetUser","setUser","useLoggedInOrRiderect","router","replace","asPath","AuthProvider","children","state","setState","undefined","value","get","then","response","data","catch"],"mappings":";;;;;;;;;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,SAAT,QAA0B,aAA1B;AACA,SACEC,aADF,EAEEC,WAFF,EAGEC,UAHF,EAIEC,SAJF,EAKEC,OALF,EAMEC,QANF,QAOO,OAPP;AASA,MAAMC,WAAW,gBAAGN,aAAa,EAAjC;AAEA,OAAO,MAAMO,OAAO,GAAG,MAAM;AAAA;;AAC3B,QAAMC,WAAW,GAAGN,UAAU,CAACI,WAAD,CAA9B;AACA,SAAOE,WAAW,CAACC,IAAnB;AACD,CAHM;;GAAMF,O;;AAKb,OAAO,MAAMG,UAAU,GAAG,MAAM;AAAA;;AAC9B,QAAMF,WAAW,GAAGN,UAAU,CAACI,WAAD,CAA9B;AACA,SAAOE,WAAW,CAACG,OAAnB;AACD,CAHM;;IAAMD,U;;AAKb,OAAO,MAAME,qBAAqB,GAAG,MAAM;AAAA;;AACzC,QAAMH,IAAI,GAAGF,OAAO,EAApB;AACA,QAAMM,MAAM,GAAGd,SAAS,EAAxB;AAEAI,EAAAA,SAAS,CAAC,MAAM;AACd,QAAIM,IAAI,KAAK,IAAb,EAAmB;AACjBI,MAAAA,MAAM,CAACC,OAAP,CAAgB,gBAAeD,MAAM,CAACE,MAAO,EAA7C;AACD;AACF,GAJQ,EAIN,CAACN,IAAD,CAJM,CAAT;AAMA,SAAOA,IAAI,KAAK,IAAhB;AACD,CAXM;;IAAMG,qB;UACEL,O,EACER,S;;;AAWjB,MAAMiB,YAAY,GAAG,CAAC;AAAEC,EAAAA;AAAF,CAAD,KAAkB;AAAA;;AACrC,QAAM;AAAA,OAACC,KAAD;AAAA,OAAQC;AAAR,MAAoBd,QAAQ,CAAC;AAAEI,IAAAA,IAAI,EAAEW;AAAR,GAAD,CAAlC;AAEA,QAAMT,OAAO,GAAGV,WAAW,CAAEQ,IAAD,IAAU;AACpCU,IAAAA,QAAQ,CAAC;AAAEV,MAAAA;AAAF,KAAD,CAAR;AACD,GAF0B,EAExB,EAFwB,CAA3B;AAIA,QAAMY,KAAK,GAAGjB,OAAO,CAAC,sCAAYc,KAAZ;AAAmBP,IAAAA;AAAnB,IAAD,EAAgC,CAACO,KAAD,CAAhC,CAArB;AAEAf,EAAAA,SAAS,CAAC,MAAM;AACdL,IAAAA,KAAK,CACFwB,GADH,CACO,eADP,EAEGC,IAFH,CAEQ,UAAUC,QAAV,EAAoB;AACxBL,MAAAA,QAAQ,CAAC;AAAEV,QAAAA,IAAI,EAAEe,QAAQ,CAACC;AAAjB,OAAD,CAAR;AACD,KAJH,EAKGC,KALH,CAKS,YAAY;AACjBP,MAAAA,QAAQ,CAAC;AAAEV,QAAAA,IAAI,EAAE;AAAR,OAAD,CAAR;AACD,KAPH;AAQD,GATQ,EASN,EATM,CAAT;;AAWA,MAAIS,KAAK,CAACT,IAAN,KAAeW,SAAnB,EAA8B;AAC5B,WAAO,IAAP;AACD;;AAED,sBAAO,QAAC,WAAD,CAAa,QAAb;AAAsB,IAAA,KAAK,EAAEC,KAA7B;AAAA,cAAqCJ;AAArC;AAAA;AAAA;AAAA;AAAA,UAAP;AACD,CAzBD;;IAAMD,Y;;KAAAA,Y;AA2BN,eAAeA,YAAf","sourcesContent":["import axios from \"axios\";\r\nimport { useRouter } from \"next/router\";\r\nimport {\r\n  createContext,\r\n  useCallback,\r\n  useContext,\r\n  useEffect,\r\n  useMemo,\r\n  useState,\r\n} from \"react\";\r\n\r\nconst AuthContext = createContext();\r\n\r\nexport const useUser = () => {\r\n  const authContext = useContext(AuthContext);\r\n  return authContext.user;\r\n};\r\n\r\nexport const useSetUser = () => {\r\n  const authContext = useContext(AuthContext);\r\n  return authContext.setUser;\r\n};\r\n\r\nexport const useLoggedInOrRiderect = () => {\r\n  const user = useUser();\r\n  const router = useRouter();\r\n\r\n  useEffect(() => {\r\n    if (user === null) {\r\n      router.replace(`/login/?next=${router.asPath}`);\r\n    }\r\n  }, [user]);\r\n\r\n  return user !== null;\r\n};\r\n\r\nconst AuthProvider = ({ children }) => {\r\n  const [state, setState] = useState({ user: undefined });\r\n\r\n  const setUser = useCallback((user) => {\r\n    setState({ user });\r\n  }, []);\r\n\r\n  const value = useMemo(() => ({ ...state, setUser }), [state]);\r\n\r\n  useEffect(() => {\r\n    axios\r\n      .get(\"/api/session/\")\r\n      .then(function (response) {\r\n        setState({ user: response.data });\r\n      })\r\n      .catch(function () {\r\n        setState({ user: null });\r\n      });\r\n  }, []);\r\n\r\n  if (state.user === undefined) {\r\n    return null;\r\n  }\r\n\r\n  return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>;\r\n};\r\n\r\nexport default AuthProvider;\r\n"]},"metadata":{},"sourceType":"module"}